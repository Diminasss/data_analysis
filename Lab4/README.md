# Кластеризация данных о болезнях сердца

## Цель работы
Изучение алгоритмов и методов кластеризации на практике.

## Вариант и задание
Вариант 4. Набор данных: `4heart2.csv`

### Данные о болезнях сердца:
1. **Возраст**: возраст пациента (лет)
2. **Анемия**: снижение количества эритроцитов или гемоглобина (логическое значение)
3. **Высокое кровяное давление**: если у пациента гипертония (логическое значение)
4. **Креатининфосфокиназа (КФК)**: уровень фермента КФК в крови (мкг/л)
5. **Диабет**: если у пациента диабет (логическое значение)
6. **Фракция выброса**: процент крови, покидающей сердце при каждом сокращении (в процентах)
7. **Тромбоциты**: тромбоциты в крови (килотромбоциты/мл)
8. **Пол**: женщина или мужчина (бинарный)
9. **Креатинин сыворотки**: уровень креатинина сыворотки в крови (мг/дл)
10. **Натрий сыворотки**: уровень натрия сыворотки в крови (мэкв/л)
11. **Курение**: если пациент курит или нет (логическое)
12. **Время**: период наблюдения (дни)
13. **Событие смерти**: если пациент умер в течение периода наблюдения (логическое значение)

## Ход работы

### Часть 1 - Подготовка данных
1. **Создание набора данных**:
   - Использована функция для создания набора данных.
   - Проведена стандартизация данных.

2. **Стандартизация данных**:
   - Стандартизированы значения `x` и `y`.
   - Получен DataFrame с заданным числом объектов в каждой группе (всего 3 группы) с двумя признаками: `x` и `y`.

### Часть 2 - Кластеризация
1. **Кластеризация данных**:
   - Проведено обучение и кластеризация тренировочных данных.
   - На графике чётко видно 3 кластера.

2. **Кластеризация на тестовых данных**:
   - Проведена кластеризация на тестовых данных.
   - Модель с кластеризацией справляется хорошо, на графике отчётливо видно 3 кластера.

3. **Сравнение кластеризации при различном числе кластеров**:
   - Проведена кластеризация данных при `n_clusters=2` и `n_clusters=4`.
   - При `n_clusters=2` модель становится менее точной.
   - При `n_clusters=4` нижнее левое облако делится ещё на 2 части, что указывает на менее однородные данные.

### Часть 3 - Оптимальное число кластеров
1. **Метод локтя**:
   - Построен график инерции.
   - Оптимальное число кластеров равно 3, так как излом находится на точке 3.

### Часть 4 - Кластеризация данных о болезнях сердца
1. **Предварительная обработка данных**:
   - Открыты и проведена предварительная обработка данных.
   - Нормализованы числовые данные.

2. **Матрица диаграмм рассеяния**:
   - Построена матрица диаграмм рассеяния для анализа зависимости летального исхода от различных факторов.

3. **Кластеризация методом k-means**:
   - Проведена кластеризация методом k-means.
   - Выбрано 4 кластера по методу локтя.

4. **Анализ кластеров**:
   - Кластер 0: люди с возрастом ниже среднего, высокой частотой диабета и анемии.
   - Кластер 1: люди с возрастом близким к среднему, умеренной частотой анемии и низким уровнем креатинкиназы.
   - Кластер 2: люди с возрастом выше среднего, низкой частотой диабета и высоким уровнем креатинина в сыворотке.
   - Кластер 3: люди с возрастом близким к среднему, умеренной частотой анемии и низким уровнем креатинкиназы.

5. **Метрики качества кластеризации**:
   - Silhouette Score: 0.1390 (указывает на неопределённость между кластерами).
   - Davies-Bouldin Index: 1.8348 (указывает на плохое разделение кластеров).

### Часть 5 - Иерархическая агломеративная кластеризация
1. **Дендрограмма**:
   - Построена дендрограмма, показывающая 6 групп.
   - Получены низкие значения метрик качества кластеризации.

2. **Анализ кластеров**:
   - Кластер 1: пациенты с относительно высоким возрастом и умеренными показателями по анамнестическим признакам.
   - Кластер 2: пациенты с более низким возрастом и высокими значениями по creatinine_phosphokinase.
   - Кластер 3: пациенты с хорошим уровнем ejection_fraction.
   - Кластер 4: пациенты с более низким возрастом и умеренными показателями для большинства признаков.

## Выводы
- **Предварительный анализ и стандартизация данных**:
  - Проведена стандартизация данных и предварительный анализ.
- **Методы кластеризации**:
  - Алгоритм k-means и иерархическая агломеративная кластеризация показали, что оптимальное количество кластеров — 3.
  - Метод локтя и графики подтвердили, что 3 кластера лучше всего отражают структуру данных.
- **Метрики качества кластеризации**:
  - Silhouette Score и Davies-Bouldin Index показали, что разделение на кластеры не является идеальным, но всё же даёт достаточно полезной информации о группах пациентов.

## Ссылка на Google Colab
[Google Colab Notebook](https://colab.research.google.com/drive/1Jx96NphL-zWkt1Jl6oD6fZZTrZ46leMt?usp=sharing)
